# 2024 年学习DGL



## 一、 如何使用DGL 建立一个图



```python
import dgl
import torch as th
# 边 0->1, 0->2, 0->3, 1->3
u, v = th.tensor([0, 0, 0, 1]), th.tensor([1, 2, 3, 3])
g = dgl.graph((u, v))
print(g) # 图中节点的数量是DGL通过给定的图的边列表中最大的点ID推断所得出的
# 获取节点的ID
print(g.nodes())
# 获取边的对应端点
print(g.edges())
# 获取边的对应端点和边ID
print(g.edges(form='all'))
# 如果具有最大ID的节点没有边，在创建图的时候，用户需要明确地指明节点的数量。
g = dgl.graph((u, v), num_nodes=8)

```

这段代码使用torch框架，uv是两个边的集合，在使用dgl创建图的时候需要边的起点与终点即为 u v 。 然后我们使用 dgl.graph 即可创建具有该节点与边的图。

其中节点ID 的打印结果为 tensor([0, 1, 2, 3]) 是一个张量。

我们可以对这个图进行部分的点与增加属性， 边也可以。



```python
import dgl
import torch as th
g = dgl.graph(([0, 0, 1, 5], [1, 2, 2, 0])) # 6个节点，4条边

g.ndata['x'] = th.ones(g.num_nodes(), 3)               # 长度为3的节点特征
g.edata['x'] = th.ones(g.num_edges(), dtype=th.int32)  # 标量整型特征

# 不同名称的特征可以具有不同形状
g.ndata['y'] = th.randn(g.num_nodes(), 5)
# g.ndata['x'][1]                  # 获取节点1的特征
# g.edata['x'][th.tensor([0, 3])]  # 获取边0和3的特征

```

DGL库可以使用两个接口去增加其中的点的属性。

g.ndata['x'] 指得是我们可以通过这个方法给所有的节点加入 属性x 此时我们认为其中有6 个节点 （即0-5） 其中的张量大小为 [6,3]

g.edata['x'] 指得是我们为每个边都加入的int32类型的权重，其中的大小为4

我们也可以对一组节点加入不同的属性y 每组属性都可以有不同的维度大小



例如

```python
# 边 0->1, 0->2, 0->3, 1->3
edges = th.tensor([0, 0, 0, 1]), th.tensor([1, 2, 3, 3])
weights = th.tensor([0.1, 0.6, 0.9, 0.7])  # 每条边的权重
g = dgl.graph(edges)
g.edata['w'] = weights  # 将其命名为 'w'
```

这个的g.edata['w'] 就是为图的节点加入weight的权重。